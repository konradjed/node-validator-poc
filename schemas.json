{
  "schemas": [
    {
      "$id": "roleBasedSchema",
      "type": "object",
      "properties": {
        "userType": {
          "type": "string",
          "enum": [
            "admin",
            "user",
            "guest"
          ]
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "adminSecret": {
          "type": "string"
        }
      },
      "if": {
        "properties": {
          "userType": {
            "const": "admin"
          }
        }
      },
      "then": {
        "required": [
          "adminSecret"
        ]
      },
      "else": {
        "if": {
          "properties": {
            "userType": {
              "const": "guest"
            }
          }
        },
        "then": {
          "required": [],
          "properties": {
            "permissions": {
              "const": []
            }
          }
        }
      }
    },
    {
      "$id": "roleBasedSchema-v2",
      "type": "object",
      "properties": {
        "userType": {
          "type": "string",
          "enum": [
            "admin",
            "user",
            "guest"
          ]
        },
        "permissions": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "adminSecret": {
          "type": "string"
        },
        "username": {
          "type": "string"
        }
      },
      "if": {
        "properties": {
          "userType": {
            "const": "admin"
          }
        }
      },
      "then": {
        "required": [
          "adminSecret"
        ]
      },
      "else": {
        "if": {
          "properties": {
            "userType": {
              "const": "guest"
            }
          }
        },
        "then": {
          "required": [],
          "properties": {
            "permissions": {
              "const": []
            }
          }
        }
      },
      "required": [ "username"]
    },
    {
      "$id": "customerTypeSchema",
      "type": "object",
      "properties": {
        "customerType": {
          "type": "string",
          "enum": [
            "business",
            "personal"
          ]
        },
        "companyName": {
          "type": "string"
        },
        "vatId": {
          "type": "string",
          "pattern": "^[A-Z]{2}[0-9]{10}$"
        },
        "fullName": {
          "type": "string"
        },
        "dateOfBirth": {
          "type": "string",
          "format": "date"
        }
      },
      "if": {
        "properties": {
          "customerType": {
            "const": "business"
          }
        }
      },
      "then": {
        "required": [
          "companyName",
          "vatId"
        ]
      },
      "else": {
        "required": [
          "fullName",
          "dateOfBirth"
        ]
      }
    },
    {
      "$id": "advancedValidationSchema",
      "type": "object",
      "properties": {
        "name": { "type": "string", "minLength": 3 },
        "pesel": { "type": "string", "format": "pesel" },
        "phone": { "type": "string", "format": "phone-number" },
        "iban": { "type": "string", "format": "iban" },
        "dateOfBirth": { "type": "string", "format": "date-of-birth" }
      },
      "required": ["name", "pesel", "phone", "iban", "dateOfBirth"]
    }
  ]
}